language: cpp

compiler:
  - clang
  - gcc

before_install:
  - sudo easy_install cpp-coveralls

#install:
# - sudo add-apt-repository --yes ppa:ubuntu-toolchain-r/test
# - wget -O - http://llvm.org/apt/llvm-snapshot.gpg.key | sudo apt-key add -
# - sudo add-apt-repository --yes 'deb http://llvm.org/apt/precise/ llvm-toolchain-precise main'
# - sudo apt-get -qq update
# - sudo apt-get -qq install g++-4.8
# - sudo apt-get -qq install clang-3.5

script:
  - if [ "${COVERITY_SCAN}" = '1' ]; then eval "$COVERITY_SCAN_BUILD"; else eval "$STANDARD_BUILD_COMMAND"; fi

after_success:
  # Coverage
  - if [ "${USE_COVERAGE}" = '1' ]; then make send-coverage; fi

env:
  global:
    # Default Build Command
    - STANDARD_BUILD_COMMAND="cd ./test; make showcxxversion all;"
    # Coverity Env
    - COVERITY_SCAN_BUILD_COMMAND_PREPEND="cd ./test"
    - COVERITY_SCAN_BUILD_COMMAND="make"
    - COVERITY_SCAN_BRANCH_PATTERN="master"
    - COVERITY_SCAN_BUILD_URL="https://scan.coverity.com/scripts/travisci_build_coverity_scan.sh"
    - COVERITY_SCAN_BUILD="curl -s $COVERITY_SCAN_BUILD_URL | bash"
    - PROJECT_NAME="srz-zumix/iutest"
    - OWNER_EMAIL="zumix.cpp@gmail.com"
    - secure: "p7jyD2o54mCPQg+3ZSo03/P9G5HJdgZWZ80LQG6Dt4PfNzxBcJWTM4eSZUX+HCe5jTICC7FsDLbucwJUKb5EsXyqvny3QlGp4bvB8OWN8IbroaqpR8s4qVJLzpR9UOGhn+St3dVRZ0y9g9Vjr2/8gknwzqexAwslpGaOLohHZ/0="

  matrix:
    - STDFLAG=-std=c++98
    - STDFLAG=-std=c++0x
    - USE_COVERAGE=1
    #- COVERITY_SCAN=1

matrix:
  exclude:
    - compiler: clang
      env: USE_COVERAGE=1
    - compiler: clang
      env: COVERITY_SCAN=1

