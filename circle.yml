dependencies:
  pre:
    - |
      case $CIRCLE_NODE_INDEX in
        0) export OPTIMIZE=-O2 ;;
        1) export OPTIMIZE=-Oz ;;
        2) export OPTIMIZE=-O3 ;;
        3) export OPTIMIZE=-O4 ;;
      esac

test:
  override:
    - $(CXX) --version
    - make test CXX=clang++ OUTPUTXML=1 OPTIMIZE=$(OPTIMIZE) :
        parallel: true
        pwd: test
