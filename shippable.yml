# shippable test c++98 compile...

language: python

python: 2.7
cache: true
parallelized_test: true

branches:
  except:
    - gh-pages

install:
  - pip install requests

before_script:
  - export PYTHONDONTWRITEBYTECODE=1
  - make -C tools/fused
  - mkdir -p shippable/testresults

script:
  - cd tools/wandbox
  - python ./iuwandbox.py --list_options ${WANDBOX_COMPILER}
  - python ./iuwandbox.py ../../test/syntax_tests.cpp -c ${WANDBOX_COMPILER} -f"-DIUTEST_USE_MAIN=1" -f"-Werror" --std "c++98" --boost nothing --encoding utf-8-sig --expand_include --verbose --junit ../../shippable/testresults/test_result.xml
  - python ./iuwandbox.py ../../test/syntax_tests.cpp -c ${WANDBOX_COMPILER} -f"-DIUTEST_USE_MAIN=1" -f"-Werror" --std "gnu++98" --boost nothing --encoding utf-8-sig --expand_include --verbose --junit ../../shippable/testresults/test_result_gnu.xml

env:
  matrix:
    - WANDBOX_COMPILER=gcc-head
    - WANDBOX_COMPILER=gcc-6.3.0
#    - WANDBOX_COMPILER=gcc-6.2.0
#    - WANDBOX_COMPILER=gcc-6.1.0
    - WANDBOX_COMPILER=gcc-5.4.0
#    - WANDBOX_COMPILER=gcc-5.3.0
#    - WANDBOX_COMPILER=gcc-5.2.0
#    - WANDBOX_COMPILER=gcc-5.1.0
    - WANDBOX_COMPILER=gcc-4.9.3
#    - WANDBOX_COMPILER=gcc-4.9.2
#    - WANDBOX_COMPILER=gcc-4.9.1
#    - WANDBOX_COMPILER=gcc-4.9.0
    - WANDBOX_COMPILER=gcc-4.8.5
#    - WANDBOX_COMPILER=gcc-4.8.4
#    - WANDBOX_COMPILER=gcc-4.8.3
#    - WANDBOX_COMPILER=gcc-4.8.2
#    - WANDBOX_COMPILER=gcc-4.8.1
    - WANDBOX_COMPILER=gcc-4.7.4
#    - WANDBOX_COMPILER=gcc-4.7.3
    - WANDBOX_COMPILER=gcc-4.6.4
    - WANDBOX_COMPILER=gcc-4.5.4
    - WANDBOX_COMPILER=gcc-4.4.7
    - WANDBOX_COMPILER=clang-head
    - WANDBOX_COMPILER=clang-3.9.1
    - WANDBOX_COMPILER=clang-3.8.1
    - WANDBOX_COMPILER=clang-3.7.1
    - WANDBOX_COMPILER=clang-3.6.0
    - WANDBOX_COMPILER=clang-3.5.0
#    - WANDBOX_COMPILER=clang-3.4
#    - WANDBOX_COMPILER=clang-3.3
#    - WANDBOX_COMPILER=clang-3.2
#    - WANDBOX_COMPILER=clang-3.1

after_success:
  - echo OK
  
integrations:
  notifications:
    - integrationName: email
      type: email
      on_success: change
      on_failure: always
